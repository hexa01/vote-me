@model AdminListViewModel
@{
    ViewData["Title"] = Model.PageTitle;
    Layout = "~/Views/Admin/_AdminLayout.cshtml";
    ViewBag.ActiveSection = Model.ActiveSection;
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0">
        <i class="fas fa-list me-2"></i>@Model.PageTitle
    </h1>
    <div class="text-muted">
        Total: @Model.TotalCount reports
    </div>
</div>

<!-- Search Box -->
<div class="card mb-4">
    <div class="card-body">
        <form method="get" asp-action="SearchReports" class="row g-3">
            <div class="col-md-4">
                <input type="text" name="query" class="form-control" placeholder="Search reports..."
                       value="@Model.SearchQuery">
            </div>
            <div class="col-md-3">
                <select name="category" class="form-select">
                    <option value="">All Categories</option>
                    <option value="Voter Intimidation" selected="@(Model.SearchCategory == "Voter Intimidation")">Voter Intimidation</option>
                    <option value="Ballot Tampering" selected="@(Model.SearchCategory == "Ballot Tampering")">Ballot Tampering</option>
                    <option value="Polling Station Issues" selected="@(Model.SearchCategory == "Polling Station Issues")">Polling Station Issues</option>
                    <option value="Fraudulent Voting" selected="@(Model.SearchCategory == "Fraudulent Voting")">Fraudulent Voting</option>
                    <option value="Other" selected="@(Model.SearchCategory == "Other")">Other</option>
                </select>
            </div>
            <div class="col-md-3">
                <select name="status" class="form-select">
                    <option value="">All Status</option>
                    <option value="0" selected="@(Model.SearchStatus == ReportStatus.Pending)">Pending</option>
                    <option value="2" selected="@(Model.SearchStatus == ReportStatus.Verified)">Verified</option>
                    <option value="3" selected="@(Model.SearchStatus == ReportStatus.Rejected)">Rejected</option>
                </select>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">
                    <i class="fas fa-search me-1"></i>Search
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Reports Table -->
<div class="card">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Title</th>
                        <th>Category</th>
                        <th>Status</th>
                        <th>Priority</th>
                        <th>Location</th>
                        <th>Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var report in Model.Reports)
                    {
                        <tr>
                            <td><code>@report.ReportCode</code></td>
                            <td>
                                <div class="fw-semibold text-truncate" style="max-width: 200px;" title="@report.Title">
                                    @report.Title
                                </div>
                            </td>
                            <td>@report.Category</td>
                            <td>
                                <span class="badge @report.StatusBadgeClass">@report.Status</span>
                            </td>
                            <td>
                                <span class="badge @report.PriorityBadgeClass">@report.Priority</span>
                            </td>
                            <td>
                                <small class="text-truncate d-block" style="max-width: 150px;" title="@report.Location">
                                    @report.Location
                                </small>
                            </td>
                            <td>
                                <small>@report.CreatedAt.ToString("MMM dd, yyyy")</small>
                                <br>
                                <small class="text-muted">@report.CreatedAt.ToString("hh:mm tt")</small>
                            </td>
                            <td>
                                <a asp-action="ReportDetails" asp-route-id="@report.Id"
                                   class="btn btn-sm btn-outline-primary" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            $('.table').DataTable({
                pageLength: 25,
                order: [[6, 'desc']],
                responsive: true
            });
        });
    </script>
}